import cx_Oracle
from openpyxl import Workbook

# connect to the Oracle database
dsn = cx_Oracle.makedsn(host='<hostname>', port='<port>', service_name='<service_name>')
conn = cx_Oracle.connect(user='<username>', password='<password>', dsn=dsn)

# execute the SQL statement
cur = conn.cursor()
cur.execute('<your sql statement>')

# create a new workbook and sheet
wb = Workbook()
ws = wb.active

# write the column headers to the first row
headers = [i[0] for i in cur.description]
for col_num, header in enumerate(headers, 1):
    ws.cell(row=1, column=col_num, value=header)

# write the data to the remaining rows
for row_num, row_data in enumerate(cur, 2):
    for col_num, cell_value in enumerate(row_data, 1):
        ws.cell(row=row_num, column=col_num, value=cell_value)

# save the workbook to a file
wb.save('<path/to/file.xlsx>')

# close the cursor and database connection
cur.close()
conn.close()
