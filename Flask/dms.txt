import cx_Oracle
import pandas as pd

# Connect to the Oracle database
connection = cx_Oracle.connect('username/password@hostname:port/service_name')

# Load the pandas dataframe
df = pd.read_csv('example.csv')

# Convert the date column to a compatible format
df['date_col'] = pd.to_datetime(df['date_col']).dt.strftime('%Y-%m-%d')

# Create a cursor and insert data into the Oracle table
cursor = connection.cursor()
for index, row in df.iterrows():
    cursor.execute("INSERT INTO example_table (id, date_col, other_col) VALUES (:1, :2, :3)",
                   (row['id'], row['date_col'], row['other_col']))
connection.commit()

# Close the cursor and connection
cursor.close()
connection.close()
