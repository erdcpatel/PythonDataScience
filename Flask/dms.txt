import cx_Oracle
import pandas as pd

# Create a connection to the Oracle database
dsn = cx_Oracle.makedsn(host='your_host', port=1521, service_name='your_service_name')
connection = cx_Oracle.connect(user='your_username', password='your_password', dsn=dsn)

# Create a pandas DataFrame
df = pd.DataFrame({'column1': [1, 2, 3], 'column2': ['A', 'B', 'C']})

# Define the name of the Oracle table to which you want to export the DataFrame
table_name = 'your_table_name'

# Create a cursor object
cursor = connection.cursor()

# Use the cursor object to execute the CREATE TABLE statement in Oracle
cursor.execute(f"CREATE TABLE {table_name} (column1 NUMBER, column2 VARCHAR2(10))")

# Use the tolist() method to convert the DataFrame values to a list of tuples
rows = [tuple(x) for x in df.to_records(index=False)]

# Use the executemany() method to insert the rows into the Oracle table
cursor.executemany(f"INSERT INTO {table_name} (column1, column2) VALUES (:1, :2)", rows)

# Commit the transaction
connection.commit()

# Close the cursor and connection
cursor.close()
connection.close()
