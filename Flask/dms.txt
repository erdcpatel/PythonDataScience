pip install opentelemetry-api opentelemetry-sdk opentelemetry-instrumentation-fastapi opentelemetry-exporter-jaeger

from fastapi import FastAPI
from opentelemetry import trace
from opentelemetry.sdk.trace import TracerProvider
from opentelemetry.sdk.trace.export import BatchSpanProcessor
from opentelemetry.exporter.jaeger import JaegerSpanExporter
from opentelemetry.instrumentation.fastapi import FastAPIInstrumentor

app = FastAPI()

# Set up the Tracer Provider
trace.set_tracer_provider(TracerProvider())

# Configure Jaeger exporter
jaeger_exporter = JaegerSpanExporter(
    service_name="your-fastapi-service",
    agent_host_name="your-jaeger-agent-host",
    agent_port=6831,
)

# Set up the Batch Span Processor to export traces to Jaeger
trace.get_tracer_provider().add_span_processor(
    BatchSpanProcessor(jaeger_exporter)
)

# Instrument the FastAPI application
FastAPIInstrumentor.instrument_app(app)

# Your existing FastAPI routes
@app.get("/")
async def root():
    return {"message": "Hello World"}


